---
- name: Install Transmission
  become: true
  package:
    name: transmission-daemon
    state: present

- name: Set a higher value for rmem_max
  become: true
  sysctl:
    name: "net.core.rmem_max"
    value: "4194304"
    state: present

- name: Set a higher value for rmem_max
  become: true
  sysctl:
    name: "net.core.wmem_max"
    value: "1048576"
    state: present

- name: Enable transmission-daemon
  become: true
  systemd:
    name: transmission-daemon
    enabled: true
    state: started

- name: Stop transmission-daemon
  become: true
  systemd:
    name: transmission-daemon
    state: stopped

- name: Disable rpc-whitelist
  become: true
  json_patch:
    src: "/var/lib/transmission/.config/transmission-daemon/settings.json"
    operations:
      - op: replace
        path: "/rpc-whitelist-enabled"
        value: "false"

- name: Disable rpc-host-whitelist
  become: true
  json_patch:
    src: "/var/lib/transmission/.config/transmission-daemon/settings.json"
    operations:
      - op: replace
        path: "/rpc-host-whitelist-enabled"
        value: "false"

- name: Start transmission-daemon
  become: true
  systemd:
    name: transmission-daemon
    state: started