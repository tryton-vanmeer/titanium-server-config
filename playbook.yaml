---
- hosts: vm
  tasks:
  - name: Update Packages
    become: true
    dnf:
      name: "*"
      state: latest

  - name: Install 'Fedora Server Edition' Group
    become: true
    dnf:
      name: "@Fedora Server Edition"
      state: present

  - name: Create 'storage' Group
    become: true
    group:
      name: "storage"
      state: present

  - name: Add '{{ ansible_user_id }}' to 'storage' group
    become: true
    user:
      name: "{{ ansible_user_id }}"
      groups:
        - "storage"
      append: true

  - name: Create Storage Directory
    become: true
    file:
      path: /storage
      state: directory
      group: "storage"
      mode: "u=rwx,g=rwx,o=r"

  - name: Create Storage/Media Directory
    become: true
    file:
      path: /storage/Media
      state: directory
      group: "storage"
      mode: "u=rwx,g=rwx,o=r"

  - name: Create Storage/Containers Directory
    become: true
    file:
      path: /storage/Containers
      state: directory
      group: "storage"
      mode: "u=rwx,g=rwx,o=r"


- hosts: all
  roles:
    - firewall
    - nginx
    - transmission
